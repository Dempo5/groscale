/* ---- Apple-ish base, one source of truth (light/dark) ---- */
:root{
  --bg:#0b0f15; --bg2:#0e131b;
  --surface:rgba(255,255,255,.62);
  --surface-dark:rgba(18,24,32,.55);
  --card-light:rgba(255,255,255,.75);
  --card-dark:rgba(18,24,32,.68);
  --line:rgba(0,0,0,.08);
  --line-dark:rgba(255,255,255,.08);
  --muted:#6a7480;
  --text:#0e1216;
  --text-dark:#e8eef6;
  --blue:#4f8dff; --blue-700:#2b6cf6;
  --radius:14px; --shadow:0 18px 36px rgba(0,0,0,.28);
  --sf: system-ui, -apple-system, "SF Pro Text", Segoe UI, Inter, Roboto, Arial, sans-serif;
}

body[data-theme="dark"]{
  --surface:var(--surface-dark);
  --card-light:var(--card-dark);
  --line:var(--line-dark);
  --text:var(--text-dark);
}

*{box-sizing:border-box}
.p-shell{
  min-height:100vh;
  background:
    radial-gradient(900px 600px at 15% -10%, rgba(80,140,255,.12), transparent 60%),
    radial-gradient(800px 600px at 100% 100%, rgba(40,200,255,.10), transparent 60%),
    var(--bg2);
  font:500 14px/1.55 var(--sf);
  color:var(--text);
}

/* ---- glass topbar ---- */
.p-topbar{
  position:sticky; top:0; z-index:20;
  height:60px; display:flex; align-items:center; justify-content:space-between;
  padding:0 18px; border-bottom:1px solid var(--line);
  background:linear-gradient(180deg, rgba(255,255,255,.55), rgba(255,255,255,.35));
  backdrop-filter: blur(12px);
}
body[data-theme="dark"] .p-topbar{
  background:linear-gradient(180deg, rgba(8,12,18,.55), rgba(10,15,22,.35));
}
.brand{display:flex;align-items:center;gap:10px;font-weight:800}
.brand .dot{width:10px;height:10px;border-radius:50%;
  background:linear-gradient(145deg,#6ec2ff,#4b83ff);box-shadow:0 0 0 3px rgba(90,161,255,.18)}

/* ---- layout ---- */
.p-work{
  display:grid; grid-template-columns: 64px 360px minmax(480px,1fr) 380px;
  gap:16px; padding:16px; align-items:start;
}

/* ---- left rail (collapsible) ---- */
.leftnav{
  position:sticky; top:76px; align-self:start;
  height: calc(100vh - 92px);
  border-radius:16px; border:1px solid var(--line);
  background:linear-gradient(180deg,rgba(255,255,255,.55),rgba(255,255,255,.35));
  backdrop-filter: blur(12px);
  box-shadow:var(--shadow);
  display:flex; flex-direction:column; padding:8px;
  width:64px; transition: width .22s ease;
}
body[data-theme="dark"] .leftnav{
  background:linear-gradient(180deg,rgba(12,16,22,.5),rgba(12,16,22,.35));
}
.leftnav.open{ width:200px }

.leftnav .collapse{
  height:36px; display:flex; align-items:center; justify-content:center;
  border-radius:10px; border:1px solid var(--line);
  background:rgba(255,255,255,.5); cursor:pointer; margin-bottom:8px;
}
body[data-theme="dark"] .leftnav .collapse{ background:rgba(20,26,34,.5) }
.leftnav .chev{ display:inline-grid; place-items:center; width:18px; height:18px }
.leftnav .chev svg{ width:16px; height:16px }
.leftnav .chev.right{ transform: rotate(180deg) }

.nav-item{
  display:flex; align-items:center; gap:12px; padding:10px;
  border-radius:10px; color:inherit; cursor:pointer; user-select:none;
  border:1px solid transparent; transition: background .15s ease, border-color .15s ease;
}
.nav-item svg{ width:18px; height:18px; opacity:.9 }
.nav-item .label{ opacity:0; pointer-events:none; transition:opacity .16s ease }
.leftnav.open .nav-item .label{ opacity:1; pointer-events:auto }
.nav-item:hover{ background:rgba(0,0,0,.04) }
body[data-theme="dark"] .nav-item:hover{ background:rgba(255,255,255,.06) }
.nav-item.active{ border-color:rgba(79,141,255,.35); background:rgba(79,141,255,.10) }
.nav-spacer{ flex:1 }

/* ---- panels ---- */
.panel{
  border:1px solid var(--line); border-radius:16px; background:var(--card-light);
  box-shadow:var(--shadow); overflow:hidden;
}
.panel-head{
  display:flex; align-items:center; justify-content:space-between;
  padding:12px 12px; border-bottom:1px solid var(--line); font-weight:800;
}
.title{ letter-spacing:.2px }

.ghost{
  height:36px; padding:0 12px; border-radius:10px; color:#1f5def;
  background:rgba(79,141,255,.10); border:1px solid rgba(79,141,255,.25); cursor:pointer;
}
.primary{
  height:36px; padding:0 14px; border:0; border-radius:10px; color:#fff;
  background:linear-gradient(180deg,var(--blue),var(--blue-700));
  box-shadow:0 10px 28px rgba(43,108,246,.32); cursor:pointer;
}

/* search */
.search{ padding:10px 12px; border-bottom:1px solid var(--line) }
.search input{
  width:100%; height:36px; padding:0 10px; border-radius:10px;
  border:1px solid var(--line); background:rgba(255,255,255,.6); outline:none;
}
body[data-theme="dark"] .search input{ background:rgba(16,20,28,.55); color:var(--text) }

/* list rows with subtle hover “blend” */
.rows{ margin:0; padding:0; list-style:none; }
.row{
  display:flex; align-items:center; gap:12px; padding:12px 14px;
  cursor:pointer; position:relative;
}
.row::before{
  content:""; position:absolute; inset:0; border-radius:10px;
  background:rgba(0,0,0,.04); opacity:0; transition:opacity .16s ease;
}
body[data-theme="dark"] .row::before{ background:rgba(255,255,255,.05) }
.row:hover::before{ opacity:1 }
.row.selected::before{ opacity:1; background:rgba(79,141,255,.12) }
.avatar{ width:34px; height:34px; border-radius:10px; display:grid; place-items:center;
  font-weight:800; background:linear-gradient(145deg,#f5f7fb,#e7ecf7); color:#2b3a55; border:1px solid var(--line) }
body[data-theme="dark"] .avatar{ background:linear-gradient(145deg,#1b2734,#0e151d); color:#dfe8ff; border-color:var(--line) }
.meta .name{ font-weight:800 } .meta .sub{ color:var(--muted); font-size:13px }

/* thread */
.thread{ display:flex; flex-direction:column }
.thread-head{ display:flex; align-items:center; gap:12px; padding:12px; border-bottom:1px solid var