/* GroScales — flat base, premium balance, alive on interaction */

/* ---------------- Tokens ---------------- */
:root{
  --bg: #f7f8fa;

  /* tiny deltas for separation */
  --surface-rail:   #f0f2f4;
  --surface-list:   #f5f6f8;
  --surface-chat:   #ffffff;
  --surface-detail: #f2f4f6;

  --text-primary:   #14181d;
  --text-secondary: #2f3742;
  --text-muted:     #7a8594;

  --line:        #e3e7ee;
  --line-strong: #d4dbe4;

  --shadow-xs:   0 1px 3px rgba(0,0,0,.04); /* NEW: softer default */
  --shadow-sm:   0 2px 8px rgba(0,0,0,.06);

  --accent:      #2a74ff;
  --accent-tint: color-mix(in srgb, var(--accent) 12%, transparent);

  --tag-blue:  #3478f6;
  --tag-pink:  #f052a1;
  --tag-red:   #ef4444;
  --tag-green: #22c55e;
  --tag-amber: #f59e0b;
  --tag-purple:#8b5cf6;
  --tag-cyan:  #06b6d4;
  --tag-gray:  #8892a6;

  --r-8: 8px; --r-10: 10px;
  --fs-11: 11px; --fs-12: 12px; --fs-13: 13px;
  --fs-14: 14px; --fs-15: 15px; --fs-16: 16px;

  --ease: cubic-bezier(0.2, 0.6, 0.2, 1);
  --t-fast:  .16s;
  --t-med:   .20s;
  --t-slow:  .32s; /* NEW: for Copilot gradient */
}

body[data-theme="dark"]{
  --bg: #0e1116;

  --surface-rail:   #111417;
  --surface-list:   #12161a;
  --surface-chat:   #15191d;
  --surface-detail: #14181b;

  --text-primary:   #e7ecf2;
  --text-secondary: #cbd4df;
  --text-muted:     #9da8b7;

  --line:          #252b33;
  --line-strong:   #313a45;

  --shadow-xs:     0 1px 4px rgba(255,255,255,.04); /* NEW: white-tinted in dark */
  --shadow-sm:     0 2px 8px rgba(0,0,0,.28);
}

/* ---------------- Base ---------------- */
*{ box-sizing:border-box; }
html,body,#root{ height:100%; }
body{
  margin:0; background:var(--bg); color:var(--text-primary);
  font: 500 14px/1.5 Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
}
*{
  transition:
    background-color var(--t-med) var(--ease),
    color var(--t-med) var(--ease),
    border-color var(--t-med) var(--ease),
    box-shadow var(--t-med) var(--ease),
    transform var(--t-med) var(--ease),
    grid-template-columns var(--t-med) var(--ease),
    opacity var(--t-med) var(--ease);
}

.p-shell{ min-height:100vh; display:flex; flex-direction:column; }
.matte{ backdrop-filter: saturate(110%) blur(6px); }

/* ---------------- Topbar ---------------- */
.p-topbar{
  position:sticky; top:0; z-index:30;
  height:56px; display:flex; align-items:center; justify-content:center;
  background: color-mix(in srgb, var(--surface-chat) 86%, transparent);
  border-bottom:1px solid var(--line);
}
.brand-center{ font-weight:650; letter-spacing:.2px; font-size:var(--fs-14); }
.left-toggle{
  position:absolute; left:10px; top:50%; transform:translateY(-50%);
}
.top-actions{
  position:absolute; right:10px; top:50%; transform:translateY(-50%);
  display:flex; align-items:center; gap:10px;
}
.icon-btn{
  height:32px; width:32px; display:grid; place-items:center;
  border:1px solid var(--line); border-radius:var(--r-8);
  background:var(--surface-chat);
}
.icon-btn.sm{ height:30px; width:30px; }
.icon-btn:hover{ background:color-mix(in srgb, var(--surface-chat) 92%, var(--surface-list)); }
.profile-btn{ all:unset; cursor:pointer; }
.avatar{
  width:28px; height:28px; border-radius:50%;
  display:grid; place-items:center; font-weight:700;
  border:1px solid var(--line); background:var(--surface-chat);
}

/* ---------------- Grid (flush-left rail, push content) ---------------- */
.p-work.grid{
  --rail-w: 232px;
  --detail-w: 260px; /* NEW: trimmed by ~20px */
  display:grid;
  grid-template-columns: var(--rail-w) 360px 1fr var(--detail-w);
  gap:0;
  padding:0;              /* flush edge */
  border-top:1px solid var(--line);
}
.p-work.grid.rail-closed{ --rail-w: 64px; } /* rail anchored left */

/* ---------------- Rail ---------------- */
.rail{
  background:var(--surface-rail);
  border-right:1px solid var(--line);
  padding:8px 6px; display:flex; flex-direction:column; gap:6px;
}
.rail nav{ display:flex; flex-direction:column; gap:4px; }
.rail-item{
  position:relative;
  display:flex; align-items:center; gap:10px;
  height:34px; padding:0 10px; border-radius:var(--r-8);
  color:inherit; text-decoration:none; border:1px solid transparent;
  transition: filter var(--t-med) var(--ease), background-color var(--t-med) var(--ease), transform var(--t-med) var(--ease);
}
.rail-item svg{ min-width:18px; opacity:.92; transition: transform var(--t-med) var(--ease); }
.rail-item:hover{
  background:color-mix(in srgb, var(--surface-chat) 92%, var(--surface-rail)); /* gentle brightness */
}
.rail-item:hover svg{ transform: translateX(1px); } /* tiny icon nudge only (no panel drift) */
.rail-item.active{ border-color:var(--line-strong); }
.rail-active{
  content:""; position:absolute; left:-1px; top:6px; bottom:6px; width:2px; border-radius:2px;
  background:var(--accent); opacity:.65;
}
.rail.collapsed .rail-item span{ display:none; }
.rail-foot{ margin-top:auto; padding-top:6px; border-top:1px solid var(--line); }

/* ---------------- Panels (tone-separated) ---------------- */
.panel{
  border-top:1px solid var(--line);
  border-bottom:1px solid var(--line);
  animation: sectionIn .22s var(--ease) both; /* NEW: micro-motion when changing columns/sections */
}
@keyframes sectionIn{ from{ opacity:.0; transform:translateY(4px) } to{ opacity:1; transform:translateY(0) } }

.panel.list{   background:var(--surface-list);   border-left:1px solid var(--line); }
.panel.thread{ background:var(--surface-chat); }
.panel.details{background:var(--surface-detail); border-right:1px solid var(--line); }

/* ---------------- List ---------------- */
.list{ display:flex; flex-direction:column; }
.list-head{
  display:flex; align-items:center; justify-content:space-between;
  padding:12px; border-bottom:1px solid var(--line);
}
.list-head .h{ font-size:var(--fs-13); font-weight:650; color:var(--text-secondary); }
.list-head-actions{ display:flex; align-items:center; gap:8px; }

.search{
  margin:10px 12px; display:flex; align-items:center; gap:8px;
  height:34px; border:1px solid var(--line); background:var(--surface-chat);
  padding:0 8px; border-radius:var(--r-8);
}
.search input{ border:0; outline:none; background:transparent; color:inherit; width:100%; }

.rows{ list-style:none; margin:0; padding:6px 8px; }
.row{
  display:flex; align-items:center; gap:10px; padding:8px;
  border-radius:var(--r-8); cursor:pointer; border:1px solid transparent; position:relative;
}
.row:hover{ background:color-mix(in srgb, var(--surface-chat) 92%, var(--surface-list)); }
.row.selected{ background:color-mix(in srgb, var(--surface-chat) 95%, var(--surface-list)); border-color:var(--line-strong); }
.row.selected::before{ content:""; position:absolute; left:-1px; top:6px; bottom:6px; width:2px; border-radius:2px; background:var(--accent); }
.avatar{
  width:28px; height:28px; border-radius:50%;
  display:grid; place-items:center; font-weight:700;
  border:1px solid var(--line); background:var(--surface-chat);
}
.meta .name{ font-weight:600; font-size:var(--fs-14); color:var(--text-primary); }
.meta .sub{ font-size:var(--fs-12); color:var(--text-muted); }

/* ---------------- Thread (chat) ---------------- */
.thread{ display:flex; flex-direction:column; min-height:0; }
.thread-title{ padding:12px; border-bottom:1px solid var(--line); }
.who{ display:flex; align-items:center; gap:10px; }
.who-name{ font-weight:650; font-size:var(--fs-15); color:var(--text-secondary); }
.who-sub{ font-size:var(--fs-12); color:var(--text-muted); }

.messages{
  flex:1; min-height:260px;
  overflow:auto; padding:12px;
  display:flex; flex-direction:column; gap:8px;
  scroll-behavior:smooth; overscroll-behavior-y:contain;
}
.bubble{
  max-width:min(66ch, 60%);
  display:inline-block;
  padding:10px 12px;                 /* NEW: slightly taller (py-2.5) */
  border-radius:10px;
  border:1px solid var(--line);
  background:color-mix(in srgb, var(--surface-chat) 94%, var(--line));
  box-shadow: var(--shadow-xs);       /* NEW: faint depth */
  animation: msgIn var(--t-fast) var(--ease) both;
}
.bubble:hover{                        /* NEW: touchable hover — stays flat */
  box-shadow: 0 1px 3px rgba(0,0,0,.04);
}
body[data-theme="dark"] .bubble:hover{ /* NEW: dark-mode hover tint */
  box-shadow: 0 1px 4px rgba(255,255,255,.04);
}
.bubble.mine{
  align-self:flex-end;
  background:color-mix(in srgb, #8e97a4 20%, var(--surface-chat));
  border-color:color-mix(in srgb, #8e97a4 38%, var(--line));
  box-shadow: var(--shadow-sm);
}
.bubble .stamp{ font-size:var(--fs-11); color:var(--text-muted); margin-top:4px; }
@keyframes msgIn{ from{opacity:.0; transform:translateY(4px)} to{opacity:1; transform:translateY(0)} }

/* Composer */
.composer{
  margin:10px 12px 12px;
  display:grid; grid-template-columns: 1fr auto auto; gap:8px;
}
.composer input{
  height:36px; border:1px solid var(--line); border-radius:var(--r-8); padding:0 10px;
  background:var(--surface-chat); outline:none; color:inherit;
}

/* Copilot — slower, intentional pulse + soft outer halo */
.btn-copilot{
  position:relative;
  height:32px; padding:0 12px; border-radius:var(--r-8);
  border:1px solid var(--line); background:var(--surface-chat);
  display:inline-flex; align-items:center; gap:8px; cursor:pointer;
  isolation:isolate;
  box-shadow: 0 0 8px rgba(120,120,255,.30); /* faint outer halo */
}
.btn-copilot.slow .copilot-aura{
  content:""; position:absolute; inset:-2px; border-radius:inherit; z-index:1; pointer-events:none;
  opacity:.35; filter:blur(10px);
  background:
    conic-gradient(from 0deg,
      #7aa2ff 0deg, #c68bff 120deg, #6bd3ff 240deg, #7aa2ff 360deg);
  animation: copilot-gradient 3.2s ease-in-out infinite; /* NEW: slow cycle */
}
.btn-copilot.is-active .copilot-aura{ opacity:.5; filter:blur(12px); }
@keyframes copilot-gradient{
  0%   { transform: rotate(0deg);   opacity:.34 }
  50%  { transform: rotate(180deg); opacity:.46 }
  100% { transform: rotate(360deg); opacity:.34 }
}

/* Send */
.btn-primary{
  height:32px; padding:0 12px; border-radius:var(--r-8);
  border:1px solid color-mix(in srgb, var(--accent) 40%, var(--line));
  background:var(--accent); color:#fff; cursor:pointer;
}
.btn-primary:disabled{ opacity:.6; cursor:not-allowed; }
.btn-primary:not(:disabled):hover{ filter:brightness(1.04); }
.btn-primary.is-ready:hover{ box-shadow: 0 0 0 3px var(--accent-tint); }

/* ---------------- Details (right) — tightened width & rhythm ---------------- */
.panel.details{ width: var(--detail-w); }
.group + .group{ border-top:1px solid var(--line); }
.group-title{
  padding:10px 12px; font-size:var(--fs-12); color:var(--text-muted);
  text-transform:uppercase; letter-spacing:.04em;
}
.kv{
  display:grid; grid-template-columns: 1fr auto;
  align-items:center;
  gap:8px; padding:8px 12px; /* 8px rhythm */
  border-bottom:1px solid var(--line);
}
.kv:last-child{ border-bottom:0; }
.kv label{
  color:var(--text-muted); font-size:var(--fs-11);
  letter-spacing:.02em; text-transform:uppercase; line-height:1.25;
}
.copy-row{ display:inline-flex; align-items:center; gap:8px; }
.placeholder{
  color:var(--text-muted);
  background: color-mix(in srgb, var(--surface-detail) 92%, transparent);
  border:1px dashed var(--line);
  border-radius:6px; padding:1px 6px; font-size:var(--fs-12);
}

/* Tags = the emotional layer */
.tag-row{ display:flex; flex-wrap:wrap; gap:6px; padding:10px 12px; }
.tag{
  --tag-bg: var(--tag-gray);
  display:inline-flex; align-items:center; gap:6px;
  height:22px; padding:0 8px; border-radius:999px; font-size:var(--fs-12);
  color:#fff; background:var(--tag-bg); border:1px solid color-mix(in srgb, var(--tag-bg) 55%, #0000);
}
.tag[data-color="blue"]  { --tag-bg: var(--tag-blue); }
.tag[data-color="pink"]  { --tag-bg: var(--tag-pink); }
.tag[data-color="red"]   { --tag-bg: var(--tag-red); }
.tag[data-color="green"] { --tag-bg: var(--tag-green); }
.tag[data-color="amber"] { --tag-bg: var(--tag-amber); }
.tag[data-color="purple"]{ --tag-bg: var(--tag-purple); }
.tag[data-color="cyan"]  { --tag-bg: var(--tag-cyan); }
.tag[data-color="gray"]  { --tag-bg: var(--tag-gray); }

/* Utilities */
.btn-sm{
  height:32px; padding:0 10px; border:1px solid var(--line);
  border-radius:var(--r-8); background:var(--surface-chat); cursor:pointer;
}
.btn-sm:hover{ background:color-mix(in srgb, var(--surface-chat) 92%, var(--surface-list)); }

.chip{
  height:24px; display:inline-flex; align-items:center; gap:6px;
  padding:0 8px; border:1px solid var(--line); border-radius:999px;
  background:var(--surface-chat); font-size:var(--fs-12); cursor:pointer;
}
.chip:hover{ background:color-mix(in srgb, var(--surface-chat) 92%, var(--surface-detail)); }

/* A11y focus */
:focus-visible{
  outline:0;
  box-shadow: 0 0 0 3px var(--accent-tint);
  border-color: var(--line-strong);
}